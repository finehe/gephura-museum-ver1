import{H as a,a as e,e as t,f as o,c as s,w as r,i,o as n,g as d,h as c,A as l,B as u,F as f,l as h,C as g,t as m}from"./index-B3zB-9EW.js";import{_ as v,S as b,f as p}from"./SidebarNav.DHBU1t21.js";const S=v({name:"History",components:{SidebarNav:b},data:()=>({conversations:[]}),onLoad(){this.fetchChatHistory()},methods:{toggleSidebar(){this.$refs.sidebarNav?this.$refs.sidebarNav.toggleSidebar():console.error("SidebarNav component not found")},fetchChatHistory(){const t=a("userInfo");if(!t)return void console.error("User info not found");const{uid:o,uuid:s}=t,r=a("token");r?e({url:`${p}/chat/chatHistory`,method:"POST",header:{Authorization:`Bearer ${r}`},data:{uid:o,uuid:s,pageNumber:1,pageSize:20},success:a=>{200===a.data.code?this.conversations=a.data.data:console.error("Failed to fetch chat history:",a.data.message)},fail:a=>{console.error("Request failed:",a)}}):console.error("Token not found")},formatDate:a=>new Date(a).toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),openChat(a){t({url:`/pages/talk/talk?chatGroupId=${a}`})}}},[["render",function(a,e,t,v,b,p){const S=h,_=g,y=i,C=o("SidebarNav");return n(),s(y,{class:"history-container"},{default:r((()=>[d(y,{class:"history-header"},{default:r((()=>[d(S,{class:"title"},{default:r((()=>[c("历史对话")])),_:1}),d(_,{class:"toggle-sidebar-button",onClick:p.toggleSidebar},{default:r((()=>[c("☰")])),_:1},8,["onClick"])])),_:1}),d(y,{class:"conversation-list"},{default:r((()=>[(n(!0),l(f,null,u(b.conversations,((a,e)=>(n(),s(y,{class:"conversation-item",key:e,onClick:e=>p.openChat(a.chatGroupId)},{default:r((()=>[d(S,{class:"conversation-title"},{default:r((()=>[c(m(a.question),1)])),_:2},1024),d(S,{class:"conversation-date"},{default:r((()=>[c(m(p.formatDate(a.addedTime)),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1}),d(C,{ref:"sidebarNav"},null,512)])),_:1})}],["__scopeId","data-v-7baab859"]]);export{S as default};
